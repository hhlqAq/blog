# 一、基础优化：开启缓存（性价比最高，零成本见效）
核心是复用之前的构建结果，避免重复解析、转译、打包，这是提升二次构建速度的关键（你的项目模块数超 300 个，效果尤为明显）。
## 1. 开启 Webpack 构建缓存
Webpack 5 内置缓存机制，Vue CLI 3（Webpack 4）需手动配置，支持内存缓存（默认）和磁盘缓存（持久化，推荐）。
- 收益：二次构建速度提升 70%-90%（首次构建 40s → 二次构建 5-8s）；
- 原理：未修改的模块（如 Vue 核心、第三方依赖、未改动的业务组件）直接复用缓存的编译结果，跳过 Babel 转译、ESLint 校验等步骤。
```js
// vue.config.js（Vue CLI 3/4 配置）
module.exports = {
  configureWebpack: {
    cache: {
      type: 'filesystem', // 磁盘缓存（持久化，下次启动仍可用）
      cacheDirectory: '.webpack-cache', // 缓存目录（自定义）
      // 可选：指定缓存失效条件（默认按文件内容哈希判断）
      buildDependencies: {
        config: [__filename] // 配置文件修改时，缓存失效
      }
    }
  }
};
```
## 2. 缓存 loader 结果（babel-loader/eslint-loader 等）
loader 处理文件时（如 Babel 转译 ES6+），可缓存处理结果，避免重复转译。
- 收益：JS/TS 转译速度提升 50%+，ESLint 校验速度提升 80%+；
- 原理：loader 会根据文件内容哈希生成缓存键，文件未修改时直接复用处理结果。
```js
// vue.config.js 中配置 loader 缓存
module.exports = {
  chainWebpack: (config) => {
    // 1. babel-loader 缓存（转译 JS/TS）
    config.module
      .rule('js')
      .use('babel-loader')
      .tap((options) => ({
        ...options,
        cacheDirectory: true, // 开启缓存（默认缓存到 node_modules/.cache/babel-loader）
        cacheCompression: false // 禁用缓存文件压缩（牺牲一点磁盘空间，换更快的读取速度）
      }));

    // 2. eslint-loader 缓存（代码校验）
    config.module
      .rule('eslint')
      .use('eslint-loader')
      .tap((options) => ({
        ...options,
        cache: true, // 开启缓存
        cacheLocation: '.eslint-cache' // 缓存目录
      }));
  }
};
```
# 二、缩小构建范围：只处理必要的文件
## 3. 配置 exclude/include 精准匹配文件
明确指定 loader 只处理业务代码，排除 node_modules 等无需处理的目录。
- 收益：构建时间减少 10%-20%（模块数越多，效果越明显）；
- 原理：减少 loader 遍历的文件数量，避免无效处理。
```js
// vue.config.js 中优化 loader 匹配范围
module.exports = {
  chainWebpack: (config) => {
    config.module
      .rule('js')
      .include.add(resolve('src')) // 只处理 src 目录下的业务代码
      .end()
      .exclude.add(/node_modules/) // 排除 node_modules（第三方依赖无需转译）
      .end();

    // 同理优化 css-loader、vue-loader 等，只匹配必要文件
  }
};
```
## 4. 禁用不必要的插件和 loader
- 开发环境（mode: development）：禁用 terser-webpack-plugin（代码压缩）、mini-css-extract-plugin（CSS 抽离），改用 style-loader 内嵌 CSS（更快）；
- 生产环境：只保留核心插件（如 HtmlWebpackPlugin、CopyWebpackPlugin），移除调试类插件（如 webpack-bundle-analyzer，按需启用）。
- 收益：开发环境构建速度提升 30%+，避免无用工作消耗资源。
```js
// vue.config.js 按环境区分插件
module.exports = {
  configureWebpack: (config) => {
    if (process.env.NODE_ENV === 'development') {
      // 开发环境：移除压缩插件
      config.optimization.minimize = false;
      // 开发环境：用 style-loader 替代 mini-css-extract-plugin
      config.plugins = config.plugins.filter(
        (plugin) => plugin.constructor.name !== 'MiniCssExtractPlugin'
      );
    }
  }
};
```
# 三、并行 / 多线程处理：利用 CPU 多核能力
Webpack 默认单线程构建，可通过多线程工具并行处理耗时任务（如 Babel 转译、代码压缩）。
## 5. 用 thread-loader 并行处理 loader 任务
将耗时的 loader（如 babel-loader、ts-loader）放到多线程中执行，充分利用 CPU 多核。
- 依赖：需安装 thread-loader（npm i thread-loader -D）；
- 收益：JS 转译速度提升 40%-60%（模块数越多，并行优势越明显）；
- 注意：线程启动有开销，小型项目（模块数 < 100）可能反而变慢，适合中大型项目。
```js
// vue.config.js 配置 thread-loader
module.exports = {
  chainWebpack: (config) => {
    // 在 babel-loader 前添加 thread-loader
    config.module
      .rule('js')
      .use('thread-loader')
      .loader('thread-loader')
      .options({
        workers: require('os').cpus().length - 1 // 线程数 = CPU 核心数 - 1（避免占满 CPU）
      })
      .end()
      .use('babel-loader')
      .tap((options) => ({ ...options, cacheDirectory: true }));
  }
};
```
## 6. 用 terser-webpack-plugin 多线程压缩代码
生产环境代码压缩（Terser）是耗时大户，开启多线程压缩可大幅提速。

- 依赖：Webpack 5 内置 terser-webpack-plugin，Webpack 4 需手动安装（npm i terser-webpack-plugin@4 -D）；
- 收益：生产环境代码压缩时间减少 50%-70%（打包体积越大，效果越明显）。
```js
// vue.config.js 配置多线程压缩
module.exports = {
  configureWebpack: {
    optimization: {
      minimizer: [
        new require('terser-webpack-plugin')({
          parallel: true, // 开启多线程压缩
          terserOptions: {
            compress: {
              drop_console: process.env.NODE_ENV === 'production' // 生产环境移除 console
            }
          }
        })
      ]
    }
  }
};
```
# 四、工具链优化：替换低效工具 / 启用优化特性
## 7. 用 swc-loader 替代 babel-loader（极致转译速度）
swc 是 Rust 编写的工具，转译速度比 Babel 快 10-20 倍，可无缝替换 babel-loader（支持 ES6+、TS、React/Vue）。

- 依赖：安装 swc-loader（npm i swc-loader @swc/core -D）；
- 收益：JS 转译速度提升 80%+（300 模块项目转译时间从 15s 降至 2s）；
- 注意：若项目依赖特殊 Babel 插件（如 @babel/plugin-transform-runtime），需确认 swc 是否支持（大部分场景兼容）。

```js
// vue.config.js 用 swc-loader 替代 babel-loader
module.exports = {
  chainWebpack: (config) => {
    // 移除原有的 babel-loader
    config.module.rule('js').uses.delete('babel-loader');
    // 添加 swc-loader
    config.module
      .rule('js')
      .use('swc-loader')
      .loader('swc-loader')
      .options({
        jsc: {
          parser: {
            syntax: 'ecmascript', // 支持 ES6+
            jsx: false // Vue 项目禁用 JSX
          },
          target: 'es2015' // 转译目标版本
        },
        cache: true // 开启缓存
      });
  }
};
```
## 8. 启用 Webpack 5 持久化缓存和模块联邦
如果项目已升级 Webpack 5，可开启以下特性：
- 持久化缓存：cache: { type: 'filesystem' }，缓存持久化到磁盘，下次启动无需重新构建；
- 模块联邦：拆分项目为多个独立子应用，子应用单独构建，主应用按需加载（适合大型单体项目拆分）；
- 模块嵌套优化：Webpack 5 自动优化模块嵌套，减少不必要的依赖解析。  

# 五、其他优化：细节处进一步提速

## 9. 优化 resolve 配置（减少模块查找时间）

Webpack 解析模块时（如 import Vue from 'vue'），会按 resolve 配置的规则查找文件，优化规则可减少 IO 开销。

- 收益：模块解析时间减少 20%-30%，尤其适合依赖多的项目

```js
// vue.config.js 优化 resolve 配置
module.exports = {
  configureWebpack: {
    resolve: {
      extensions: ['.js', '.vue', '.json'], // 只保留常用扩展名，避免遍历所有可能
      alias: {
        // 别名配置：直接指向源码目录，减少查找层级
        '@': resolve('src'),
        'components': resolve('src/components'),
        'utils': resolve('src/utils')
      },
      modules: [resolve('src'), 'node_modules'], // 优先查找 src 目录，再找 node_modules
      symlinks: false // 禁用符号链接解析（避免额外 IO 操作，开发环境可开启）
    }
  }
};
```
## 10. 禁用 source-map（开发环境可选）
source-map 生成耗时且占用内存，开发环境可禁用或使用快速模式：
- 收益：开发环境构建速度提升 15%-25%，生产环境打包体积减少 30%+。
```js
// vue.config.js 优化 source-map
module.exports = {
  productionSourceMap: false, // 生产环境禁用 source-map（减少打包体积和时间）
  configureWebpack: (config) => {
    if (process.env.NODE_ENV === 'development') {
      config.devtool = 'eval-cheap-module-source-map'; // 开发环境用快速 source-map 模式
    }
  }
};
```