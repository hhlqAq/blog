# http2
提高性能的主要手段：连接复用，头部压缩，server push

http2 的多路复用其实是复用TCP连接，一个TCP连接由（clientIP、hostIp、clientPort、hostPort）组成，只要是同一个hostIp，即使是不同的域名，也会复用同一个TCP连接。

针对优化
- 尽可能使用统一域名、Ip地址和证书，减少建立连接的成本。
- 对于请求是否成功复用连接或preconnect，需要关注 credentials是否一致。
- 跨域名也可以复用连接
- 停用域名拆分，如果需要保留对http1用户的优化，至少让多个域名指向同一个Ip地址，从而在http2中复用TCP连接。

## 头部压缩
方案
- 限制cookie作用范围
- 使用无cookie域名（静态资源、打点请求）
- hpack 压缩头部字段

## http2存在的问题
- TCP队头阻塞：http2 是基于 TCP 协议的，而 TCP 协议是一种面向连接的、可靠的、基于字节流的传输层协议。在 TCP 协议中，数据是按序发送和接收的，每个数据段都有一个序号。如果一个数据段因为某种原因（如网络拥堵）而没有被及时接收，那么后面的数据段就会被阻塞在队头，导致性能下降。
- 头部压缩：http2 引入了头部压缩机制，但是压缩算法的效率仍然存在问题。如果压缩算法的效率不高，那么就会导致压缩后的头部数据量增加，从而增加了网络传输的成本。
- 服务器推送：不太能解决推送资源和本地缓存之间的冲突。