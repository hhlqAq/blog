# 度量指标
## 均值
均值（平均值） 是最基础且常用的统计指标，用于反映一组性能数据的整体平均水平（如平均页面加载时间、平均长任务耗时等）。它能快速给出性能的宏观概况，但需注意其易受极端值影响的局限性，通常需结合分位数等指标综合分析。

## 分位数
分位数（如 P50、P75、P90、P95、P99 等）是评估用户体验分布的关键指标，能更全面地反映性能表现（而非仅看平均值）。

分位数（Quantile）：将一组数据按升序排列后，处于特定位置的数值。例如：

P50（中位数）：50% 的样本小于等于该值（一半用户的体验达标）。

P90：90% 的样本小于等于该值（绝大多数用户的体验达标）。

P99：99% 的样本小于等于该值（极端场景下的用户体验）。


## 秒开率
秒开率是核心的用户体验指标，指页面在规定时间阈值（通常为 1 秒，也可根据业务场景调整为 2 秒等）内完成关键加载环节的用户占比。它直接反映了用户 “快速打开页面” 的体验达标率，是业务侧和技术侧都高度关注的核心指标之一。


#  度量首屏
以用户体验为中心的性能指标大致有 FP，FCP，FMP，TTI 等。

## FP（First Paint）
用于标记浏览器首次将像素渲染到屏幕上的时间点，标志着页面从 “空白” 到 “出现内容” 的关键转变。仅关注 “是否有内容呈现”，不关心内容的完整性或可用性。

计算方法：FP = 浏览器首次将像素渲染到屏幕上的时间点 - 页面加载开始时间点 

```js
const fpTime = performance.timing.firstPaint - performance.timing.navigationStart;
```

行业参考标准：
- 优秀水平：FP ≤ 800ms（Wi-Fi/5G 环境，移动端）；
- 合格水平：FP ≤ 1200ms；
- 待优化：FP > 1500ms，需优先优化首屏渲染阻塞问题（如内联关键 CSS、减少首屏不必要资源）。

## FCP（First Contentful Paint）
用于标记浏览器首次在视口中绘制出 “有意义内容”（文本，图像，canvas等） 的时间点，比 FP（首次绘制）更能反映用户实际感知到的页面加载进度。

计算方法：FCP = 浏览器首次在视口中绘制出 “有意义内容” 的时间点 - 页面加载开始时间点 

```js
const fcpTime = performance.timing.firstContentfulPaint - performance.timing.navigationStart;
```

行业参考标准：
- 优秀水平：FCP ≤ 1000ms（Wi-Fi/5G 环境，移动端）；
- 合格水平：FCP ≤ 1800ms；
- 待优化：FCP > 2500ms，需优先排查渲染阻塞、首屏资源加载瓶颈。

## FMP（First Meaningful Paint）
是反映用户核心体验的关键指标，用于标记页面 “主要内容”（新闻页的正文、电商的商品图，标题，价格、搜索页的结果列表） 首次完整呈现的时间点，比 FCP（首次内容绘制）更贴近用户对 “页面加载完成核心信息” 的感知。

计算方法：FMP = 浏览器首次在视口中绘制出 “主要内容” 的时间点 - 页面加载开始时间点 

大多使用业务自定义方案，根据业务场景和页面复杂度，确定 “主要内容” 的渲染时机。

```js
const fmpTime = performance.timing.domContentLoadedEventEnd - performance.timing.navigationStart;
```

行业参考标准：
- 优秀水平：FMP ≤ 1500ms（Wi-Fi/5G 环境，移动端）；
- 合格水平：FMP ≤ 2000ms；
- 待优化：FMP > 3000ms，需优先优化页面渲染阻塞、首屏资源加载瓶颈。

## TTI（Time to Interactive）
可交互时间，指页面在加载完成后，所有非阻塞资源（如图片、字体等）加载完成，且页面所有交互元素（如按钮、链接等）可点击的时间点。它展示了页面的可交互性和响应性。

行业参考标准：
- 优秀水平：TTI ≤ 2500ms（Wi-Fi/5G 环境，移动端）；
- 合格水平：TTI ≤ 3500ms；
- 待优化：TTI > 4500ms，需优先优化页面渲染阻塞、首屏资源加载瓶颈。

## TBT（Total Blocking Time）
衡量的是从 首次内容绘制（FCP） 到 可交互时间（TTI） 这一关键阶段内，浏览器主线程因执行长任务而被阻塞的总时长。

关键前提：长任务指执行时间超过 50ms 的任务（浏览器主线程被占用超过 50ms 时，用户交互会出现可感知的延迟）

阻塞时间计算：单个长任务的阻塞时间 = 任务执行时长 - 50ms（仅统计超出 50ms 的部分，因为 50ms 内的任务通常不会导致用户感知到延迟）。

总阻塞时间：将 FCP 到 TTI 期间所有长任务的阻塞时间累加，即为 TBT。

假设 FCP 到 TTI 之间存在 3 个长任务：
任务 1：执行时长 70ms → 阻塞时间 = 70 - 50 = 20ms；
任务 2：执行时长 120ms → 阻塞时间 = 120 - 50 = 70ms；
任务 3：执行时长 200ms → 阻塞时间 = 200 - 50 = 150ms；
则 TBT = 20 + 70 + 150 = 240ms。

### 核心意义
- 反映交互延迟风险：TBT 数值越高，说明主线程被阻塞的总时间越长，用户在该阶段触发的交互（如点击按钮、输入文本）越可能出现响应延迟，体验越卡顿。
- 衔接加载与交互指标：FCP 标志页面开始呈现内容，TTI 标志页面进入稳定可交互状态，TBT 填补了两者之间 “内容可见但交互可能卡顿” 的性能评估空白。
- 指导优化方向：TBT 升高通常源于长任务（如大型 JS 脚本执行、复杂 DOM 操作、密集计算），优化 TBT 需聚焦于拆分长任务、减少主线程工作量。

行业优化标准
- 优秀水平：移动设备 TBT ≤ 300ms，桌面设备 ≤ 100ms；
- 合格水平：移动设备 300ms < TBT ≤ 600ms，桌面设备 100ms < TBT ≤ 300ms；
- 待优化：移动设备 TBT > 600ms，桌面设备 TBT > 300ms。

##  CLS（Cumulative Layout Shift）
用于量化页面加载过程中布局的不稳定性，衡量用户因页面元素意外移位而产生的不良体验。

CLS 计算的是页面整个生命周期内所有意外布局偏移的累积得分，反映了页面布局的稳定性。当页面元素在加载过程中或用户交互时（非用户主动触发的移位，如点击按钮导致的布局变化），位置、尺寸突然发生改变，就会产生布局偏移，CLS 会对这些偏移进行累加统计。

常见触发场景
- 未指定尺寸的媒体元素：图片、视频、iframe 等未设置 width 和 height 属性，加载完成后尺寸突变导致布局移位；
- 动态插入内容：从服务器异步加载内容（如广告、评论列表）并插入页面，推动下方元素下移；
- 字体加载替换：自定义字体加载完成前，浏览器使用 fallback 字体渲染，字体替换后文本尺寸变化导致偏移；
- 未预留空间的交互组件：如下拉菜单、弹窗展开时未提前预留占位空间，显示后挤压周边元素；
- 动态调整元素样式：通过 JS 或 CSS 动态修改元素的 margin、padding、position 等属性，导致位置变化。

### 核心意义
- 衡量用户体验：CLS 数值越高，说明页面布局的不稳定性越大，用户在加载完成后或交互过程中触发的布局偏移越多，体验越卡顿。
- 指导优化方向：CLS 升高通常源于未预留空间的交互组件、动态调整元素样式等场景，优化 CLS 需关注这些场景，提前预留占位空间、避免动态调整元素样式。

行业优化标准
- 优秀水平：CLS ≤ 0.1；
- 合格水平：0.1 < CLS ≤ 0.25；
- 待优化：CLS > 0.25。

## SI（Speed Index）
衡量页面加载过程中 “视觉呈现速度” 的核心指标，它量化了页面从开始加载到视觉上完全呈现的平均时间，聚焦于用户感知到的页面加载进度，而非单纯的技术层面完成时间。

### 计算逻辑
- 捕获加载时序截图：从页面开始加载（navigationStart）起，按固定时间间隔（如 100ms）对页面视口进行截图；
- 计算每帧视觉完成度：对比每一张截图与页面最终加载完成状态的截图，计算该帧的 “视觉完成百分比”（如某帧已呈现 30% 的最终内容，则完成度为 30%）；
- 计算加权平均时间：以时间为横轴、视觉完成度为纵轴，构建视觉进度曲线，通过曲线下面积计算平均加载时间，即为 Speed Index。


